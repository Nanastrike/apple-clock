<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns:fx="http://javafx.com/fxml"
            fx:controller="controller.StatisticsController"
            prefWidth="900" prefHeight="600">

    <!-- 顶部工具区 -->
    <top>
        <VBox spacing="10">

            <!-- 第一行：标题 & 视图切换 -->
            <HBox alignment="CENTER_LEFT" spacing="10">
                <Button fx:id="selectDateRangeButton" text="选择时间范围" onAction="#onDateRangeButtonClicked"/>
                <Button text="筛选事件" onAction="#openWorkTypeSelection"/>
                <Button fx:id="toggleViewButton" text="切换视图" onAction="#handleToggleView"/>
            </HBox>



            <!-- 隐藏的日期范围弹出面板 -->
            <VBox fx:id="dateRangePanel"
                  spacing="10"
                  visible="false"
                  style="-fx-background-color: #FFFFFF; -fx-border-color: #CCCCCC; -fx-border-radius: 8;">
                <HBox spacing="10" alignment="CENTER">
                    <DatePicker fx:id="startDatePicker"/>
                    <Label text="到"/>
                    <DatePicker fx:id="endDatePicker"/>
                </HBox>

                <HBox spacing="10" alignment="CENTER">
                    <Button text="今天"      onAction="#onTodayClicked"/>
                    <Button text="昨天"      onAction="#onYesterdayClicked"/>
                    <Button text="过去7天"   onAction="#onLast7DaysClicked"/>
                    <Button text="过去30天"  onAction="#onLast30DaysClicked"/>
                </HBox>

                <HBox alignment="CENTER">
                    <Button text="确定" onAction="#onConfirmDateRange"/>
                </HBox>
            </VBox>
        </VBox>
    </top>

    <!-- 中心内容区：饼图 + 历史记录 / 日志两种互斥视图 -->
    <center>
        <StackPane>

            <!-- 饼图 & 其下方累计记录 -->
            <VBox fx:id="statsContainer" spacing="10" alignment="TOP_CENTER" >
                <PieChart fx:id="pieChart" prefHeight="400" prefWidth="400"/>
                <Label fx:id="noDataLabel" alignment="CENTER" text="No Records Found" visible="false" style="-fx-text-fill: grey; -fx-font-size: 16px; -fx-font-weight: bold;"/>
                <ScrollPane fx:id="recordsScrollPane" fitToWidth="true" >
                    <VBox fx:id="recordsContainer" spacing="6" />
                </ScrollPane>
            </VBox>

            <!-- 按日分组的日志视图（默认隐藏，切换按钮后显示） -->
            <ScrollPane fx:id="logScrollPane" fitToWidth="true" visible="false">
                <VBox fx:id="logListContainer" spacing="10"/>
            </ScrollPane>
        </StackPane>
    </center>
</BorderPane>
