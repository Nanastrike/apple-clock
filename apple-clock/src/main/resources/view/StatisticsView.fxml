<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns:fx="http://javafx.com/fxml"
            fx:controller="controller.StatisticsController"
            prefWidth="900" prefHeight="600"
            stylesheets="@/css/pie-colors.css">

    <!-- 顶部工具区 -->
    <top>
        <VBox spacing="8" style="-fx-padding:12 20 8 20;">
            <!-- 大标题 -->
            <Label fx:id="statsTitle" text="%stats.title"
                   style="-fx-font-size:24px; -fx-font-weight:bold;"/>

            <!-- 快捷按钮行 -->
            <HBox spacing="10" alignment="CENTER_LEFT">
                <Button fx:id="selectDateRangeButton"
                        text="%stats.selectDateRange"
                        onAction="#onDateRangeButtonClicked"
                        styleClass="date-button"/>
                <Button fx:id="openFilterButton"
                        text="%stats.filterEvents"
                        onAction="#openWorkTypeSelection"
                        styleClass="filter-button"/>
                <Button fx:id="toggleViewButton"
                        text="%stats.toggleView"
                        onAction="#handleToggleView"/>
            </HBox>

            <!-- 隐藏的日期面板 -->
            <VBox fx:id="dateRangePanel"
                  spacing="10"
                  visible="false"
                  style="-fx-background-color:#FFF; -fx-border-color:#CCC; -fx-border-radius:8;">
                <HBox spacing="10" alignment="CENTER">
                    <Button text="%stats.today"      onAction="#onTodayClicked"/>
                    <Button text="%stats.yesterday"  onAction="#onYesterdayClicked"/>
                    <Button text="%stats.last7Days"  onAction="#onLast7DaysClicked"/>
                    <Button text="%stats.last30Days" onAction="#onLast30DaysClicked"/>
                </HBox>
                <HBox spacing="10" alignment="CENTER">
                    <DatePicker fx:id="startDatePicker"/>
                    <Label text="%stats.rangeTo"/>
                    <DatePicker fx:id="endDatePicker"/>
                </HBox>
                <HBox alignment="CENTER">
                    <Button text="%button.confirm"
                            onAction="#onConfirmDateRange"/>
                </HBox>
            </VBox>
        </VBox>
    </top>

    <!-- 中心内容区：饼图 & 列表 & 日志 -->
    <center>
        <StackPane>
        <HBox fx:id="chartPane" spacing="20" alignment="TOP_CENTER"
              style="-fx-padding:20 30; -fx-background-color:#FAF8F4;">

            <!-- 饼图区 -->
            <StackPane prefWidth="400" prefHeight="400">
                <PieChart fx:id="pieChart"
                          styleClass="donut-chart"
                          legendVisible="false"
                          prefWidth="400" prefHeight="400"/>
                <Label fx:id="noDataLabel"
                       text="%stats.noData"
                       style="-fx-text-fill: grey; -fx-font-size:16px;"
                       visible="false"
                       alignment="CENTER"/>
            </StackPane>

            <!-- 统计列表 -->
            <ScrollPane fx:id="recordsScrollPane"
                        fitToWidth="true"
                        prefWidth="200"
                        prefHeight="400"
                        style="-fx-background-color:transparent; -fx-border-color:transparent;">
                <VBox fx:id="recordsContainer"
                      spacing="12"
                      style="-fx-background-color:white;
                             -fx-background-radius:8;
                             -fx-padding:20;
                             -fx-effect:dropshadow(one-pass-box, rgba(0,0,0,0.05),10,0,0,0);"
                      prefWidth="200"/>

            </ScrollPane>
        </HBox>

            <!-- 日志流水 -->
            <ScrollPane fx:id="logPane"
                        fitToWidth="true"
                        prefWidth="200"
                        prefHeight="400"
                        visible="false">
                <VBox fx:id="logListContainer" spacing="10"/>
            </ScrollPane>


        </StackPane>
    </center>
</BorderPane>
